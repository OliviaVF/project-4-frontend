<div ng-repeat="pylon in pylonsIndex.all | orderBy: '-created_at'" ng-if="pylon.feed">
  <div class="offset-md-3 col-md-4 feedColumn">
    <pylon-map pylon="pylon"></pylon-map>
  </div>

  <div class="col-md-6 feedColumn">
    <div class="profilePic" ng-style="{'background-image': 'url(' + pylon.user.image_src + ')'}" ui-sref="usersShow({ id: pylon.user.id })"></div>

    <h2 class="profileName">{{ pylon.user.username }}</h2>

    <p>{{ pylon.listing.name }}</p>
    <p ng-hide="pylonsIndex.categoryEditorEnabled" class="profileName">{{ pylon.category.name }}</p>

    <div ng-show="pylonsIndex.categoryEditorEnabled">
      <select ng-model="pylon.category_id" ng-show="pylonsIndex.categoryEditorEnabled">
        <option disabled selected value="">Please select...</option>
        <option ng-repeat="category in pylonsIndex.categories" ng-value="{{ category.id }}"> {{ category.name }}</option>
      </select>
      <button ng-click="pylonsIndex.categorySave(pylon)"><i class="fa fa-check" aria-hidden="true"></i></button>
      or
      <button ng-click="pylonsIndex.disableCategoryEditor()"><i class="fa fa-times" aria-hidden="true"></i></button>
    </div>

    <button ng-click="pylonsIndex.enableCategoryEditor(pylon)" ng-if="main.isAuthenticated() && main.currentUser.id === pylon.user.id"><i class="fa fa-pencil" aria-hidden="true"></i></button>
    <p>{{ pylon.listing.address }}</p>
    <p>{{ pylon.listing.website }}</p>
    <p>{{ pylon.listing.tel }}</p>
    <p ng-hide="pylonsIndex.commentEditorEnabled" class="profileName">{{ pylon.comment }}</p>

    <div ng-show="pylonsIndex.commentEditorEnabled">
      <input ng-model="pylon.comment" ng-show="pylonsIndex.commentEditorEnabled">
      <button ng-click="pylonsIndex.commentSave(pylon)"><i class="fa fa-check" aria-hidden="true"></i></button>
      or
      <button ng-click="pylonsIndex.disableCommentEditor()"><i class="fa fa-times" aria-hidden="true"></i></button>
    </div>

    <button ng-click="pylonsIndex.enableCommentEditor(pylon)" ng-if="main.isAuthenticated() && main.currentUser.id === pylon.user.id"><i class="fa fa-pencil" aria-hidden="true"></i></button>

    <div>
      <button ng-click="pylonsIndex.delete(pylon)" ng-if="main.isAuthenticated() && main.currentUser.id === pylon.user.id">Delete Post</button>
    </div>  

    <button ng-click="pylonsIndex.recreate(pylon, 'pin')" ng-if="main.isAuthenticated() && main.currentUser.id !== pylon.user.id">Pin</button>
    <button ng-click="pylonsIndex.recreate(pylon, 'repost')" ng-if="main.isAuthenticated() && main.currentUser.id !== pylon.user.id">Repost</button>
  </div>
</div>
